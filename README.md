# شرح لأداة LFI Ultimate Payload Generator

![وصف الصورة](./image/image.svg)

هذه الأداة هي مولد متقدم للهجمات من نوع Local File Inclusion (LFI)، والتي تُستخدم في اختبارات الاختراق الأخلاقي للكشف عن ثغرات قراءة الملفات المحلية في المواقع والتطبيقات الويب.

## نظرة عامة

أداة LFI Ultimate Payload Generator هي أداة مكتوبة بلغة Python لإنشاء قائمة شاملة من البايلودات (payloads) المستخدمة في اختبار ثغرات LFI. تعمل الأداة على توليد آلاف البايلودات المختلفة باستخدام تقنيات متنوعة ومتطورة للكشف عن نقاط الضعف في تطبيقات الويب.

## المميزات الرئيسية

- **توليد بايلودات متنوعة**: تنتج الأداة مجموعة واسعة من البايلودات لاستهداف أنظمة مختلفة ومسارات ملفات متعددة.
- **تقنيات تجاوز الفلترة**: تحتوي على تقنيات متعددة للتغلب على أنظمة الفلترة المختلفة في تطبيقات الويب.
- **دعم الأنظمة المختلفة**: تدعم كلاً من أنظمة Linux وWindows مع قوائم شاملة للملفات الحساسة في كل نظام.
- **بروتوكولات خاصة**: تتضمن استخدام بروتوكولات PHP الخاصة مثل php://filter وdata:// وغيرها للاستغلال.
- **ترميز متعدد**: تستخدم تقنيات ترميز URL المختلفة وترميز مزدوج لتجاوز آليات الحماية.
- **تخصيص الإخراج**: تولد ملفاً مخرجاً بتاريخ ووقت التشغيل لتسهيل تنظيم الاختبارات.

## كيفية الاستخدام

1. قم بتشغيل البرنامج باستخدام Python:
```
python run.py
```

2. سينشئ البرنامج تلقائياً ملفاً باسم `lfi_ultimate_payloads_[timestamp].txt` يحتوي على جميع البايلودات المولدة.

3. يمكن استخدام هذه البايلودات مع أدوات فحص الثغرات مثل Burp Suite أو أي أداة أخرى لاختبار تطبيقات الويب.

## تخصيص الأداة

يمكن تخصيص سلوك الأداة عن طريق تعديل المتغيرات التالية في الكود:

- `max_depth`: يحدد عمق مسارات التراجع (القيمة الافتراضية هي 4، ولا ينصح بزيادتها كثيراً)
- `enable_random_cases`: تفعيل/تعطيل استخدام أحرف كبيرة وصغيرة بشكل عشوائي
- `include_advanced_techniques`: تفعيل/تعطيل التقنيات المتقدمة
- `include_os_specific`: تفعيل/تعطيل البايلودات الخاصة بنظام التشغيل

## الفئات الرئيسية للبايلودات

### الملفات الحساسة
تستهدف الأداة مجموعة واسعة من الملفات الحساسة في أنظمة التشغيل المختلفة:

#### ملفات لينكس:
- ملفات النظام الأساسية مثل `/etc/passwd`، `/etc/shadow`
- ملفات تكوين الخوادم مثل خوادم الويب Apache و Nginx
- ملفات السجلات المختلفة
- معلومات النظام والعمليات من `/proc`
- ملفات تكوين البرامج والتطبيقات

#### ملفات ويندوز:
- ملفات النظام الأساسية
- ملفات تكوين الخوادم
- ملفات المستخدمين الحساسة

### تقنيات الاستغلال
تستخدم الأداة مجموعة متنوعة من التقنيات:

- **تقنيات الوصول المباشر**: طرق مختلفة للتراجع في المسارات مثل `../`، `..%2f`، إلخ.
- **تقنيات تجاوز الفلتر**: استراتيجيات مثل استخدام `%00`، `?`، `#`، وتقنيات أخرى.
- **البروتوكولات الخاصة**: استخدام بروتوكولات PHP وغيرها مثل `php://filter`، `data://`.
- **تقنيات متقدمة**: مزيج من التقنيات السابقة مع تشفير وترميز متعدد.

## إحصائيات وأداء

تقوم الأداة بتوليد الآلاف من البايلودات المتنوعة في ملف واحد. كمثال، قد تنتج الأداة:
- أكثر من 50,000 بايلود متنوع للاختبار
- تغطية لأكثر من 150 ملف حساس في أنظمة مختلفة
- استخدام أكثر من 30 تقنية تجاوز مختلفة

## تنبيه أمني

هذه الأداة مخصصة فقط لأغراض اختبار الاختراق المصرح به والأبحاث الأمنية. استخدام هذه الأداة على أنظمة غير مصرح باختبارها قد يكون غير قانوني.

## متطلبات التشغيل

- Python 3.x
- المكتبات القياسية (os, argparse, datetime, random, socket, platform, urllib.parse)

## الإخراج

عند تشغيل الأداة، ستحصل على:
- ملف نصي يحتوي على جميع البايلودات المولدة
- عدد البايلودات التي تم إنشاؤها
- وقت وتاريخ الإنشاء
- معلومات حول النظام المضيف

---

يمكن استخدام هذه الأداة كجزء من مجموعة أدوات اختبار الاختراق الأخلاقي لتحسين اكتشاف ثغرات LFI في تطبيقات الويب والمساعدة في تعزيز أمن تلك التطبيقات.
